<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Painel de Admin</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openUserModal(null)">
        <ion-icon slot="icon-only" name="add-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="stats-header">
    <ion-icon name="people" color="primary"></ion-icon>
    <h3>Total de Usuários: {{ users.length }}</h3>
  </div>

  <ion-grid>
    <ion-row>
      <ion-col size="12" size-md="6" *ngFor="let user of users">
        <ion-card class="user-card">
          <ion-card-header>
            <ion-item lines="none" class="user-card-title">
              <ion-avatar slot="start">
                
                <ion-icon 
                  *ngIf="user.role === 'admin'" 
                  name="shield-checkmark" 
                  class="avatar-icon admin-icon">
                </ion-icon>
                <ion-icon 
                  *ngIf="user.role !== 'admin'" 
                  name="person-circle" 
                  class="avatar-icon user-icon">
                </ion-icon>
                </ion-avatar>
              <ion-label>
                <h2>{{ user.nome }}</h2>
                <p>{{ user.email }}</p>
              </ion-label>
            </ion-item>
          </ion-card-header>

          <ion-card-content>
            <ion-list>
              <ion-item lines="none">
                <ion-icon name="call-outline" slot="start" color="medium"></ion-icon>
                <ion-label>{{ user.telefone || 'Não informado' }}</ion-label>
              </ion-item>
            </ion-list>
          </ion-card-content>

          <ion-footer class="card-footer">
            <ion-button fill="clear" color="primary" (click)="openUserModal(user)">
              <ion-icon slot="start" name="pencil"></ion-icon>
              Editar
            </ion-button>
            <ion-button fill="clear" color="danger" (click)="deleteUserConfirm(user)">
              <ion-icon slot="start" name="trash"></ion-icon>
              Excluir
            </ion-button>
          </ion-footer>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <div *ngIf="users.length === 0" class="empty-state">
    <ion-icon name="people-outline"></ion-icon>
    <p>Nenhum usuário encontrado.</p>
  </div>


  <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeUserModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>{{ modalTitle }}</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeUserModal()">Fechar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        <form [formGroup]="userForm" (ngSubmit)="saveUser()">
          <ion-list>
            <ion-item>
              <ion-input
                label="Nome Completo"
                labelPlacement="floating"
                formControlName="nome"
                type="text"
                required>
              </ion-input>
            </ion-item>
            <ion-note slot="error" *ngIf="userForm.get('nome')?.invalid && userForm.get('nome')?.touched">
              Nome é obrigatório
            </ion-note>

            <ion-item>
              <ion-input
                label="E-mail"
                labelPlacement="floating"
                formControlName="email"
                type="email"
                required>
              </ion-input>
            </ion-item>

            <ion-item>
              <ion-input
                label="Telefone"
                labelPlacement="floating"
                formControlName="telefone"
                type="tel"
                placeholder="(99) 99999-9999">
              </ion-input>
            </ion-item>

            </ion-list>

          <div class="ion-padding">
            <ion-button type="submit" expand="block" [disabled]="userForm.invalid">
              Salvar
            </ion-button>
          </div>

        </form>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>